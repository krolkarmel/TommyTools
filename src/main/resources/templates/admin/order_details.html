<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head><meta charset="utf-8"/><title>Szczegóły zamówienia</title></head>
<body style="font-family:system-ui; margin:0; background:#fafafa; color:#111;">
<div th:replace="~{fragments/navbar :: nav}"></div>

<main style="max-width:980px; margin:22px auto; padding:0 16px;">
    <h1 style="margin:10px 0;">Szczegóły: <span th:text="${o.orderNo}">TT</span></h1>

    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:14px; align-items:start;">
        <div style="background:#fff; border:1px solid #e5e5e5; border-radius:16px; padding:14px;">
            <div style="font-weight:900; margin-bottom:8px;">Dane</div>
            <div><b th:text="${o.fullName}">X</b></div>
            <div th:text="${o.email}">mail</div>
            <div th:text="${o.address}">adres</div>
            <div><span th:text="${o.postalCode}">00-000</span> <span th:text="${o.city}">Miasto</span></div>
            <div style="margin-top:8px; color:#666;" th:if="${o.username != null}">
                Użytkownik: <b th:text="${o.username}">user</b>
            </div>
            <div style="margin-top:8px; color:#666;" th:if="${o.notes != null && !#strings.isEmpty(o.notes)}">
                Uwagi: <span th:text="${o.notes}">-</span>
            </div>
        </div>

        <div style="background:#fff; border:1px solid #e5e5e5; border-radius:16px; padding:14px;">
            <div style="font-weight:900; margin-bottom:8px;">Status</div>

            <form th:action="@{'/admin/orders/' + ${o.id} + '/status'}" method="post" style="display:flex; gap:10px; align-items:center;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <select name="status" style="padding:10px 12px; border-radius:12px; border:1px solid #ddd; width:100%;">
                    <option th:each="s : ${statuses}" th:value="${s}" th:selected="${s == o.status}" th:text="${s}">NEW</option>
                </select>
                <button type="submit" style="padding:10px 12px; border-radius:12px; border:1px solid #ddd; background:#fff; cursor:pointer; font-weight:800;">
                    Zapisz
                </button>
            </form>

            <div style="margin-top:12px; font-weight:900;">
                Suma: <span th:text="${o.totalPrice} + ' zł'">0</span>
            </div>
        </div>
    </div>

    <div style="margin-top:14px; background:#fff; border:1px solid #e5e5e5; border-radius:16px; padding:14px;">
        <div style="font-weight:900; margin-bottom:10px;">Produkty</div>

        <div th:each="it : ${o.items}"
             style="display:flex; justify-content:space-between; border-bottom:1px solid #f0f0f0; padding:10px 0;">
            <div>
                <div style="font-weight:700;" th:text="${it.productName}">Nazwa</div>
                <div style="color:#666; font-size:13px;">Ilość: <b th:text="${it.quantity}">1</b></div>
            </div>
            <div style="text-align:right; font-weight:900;" th:text="${it.lineTotal} + ' zł'">0</div>
        </div>
    </div>

    <p style="margin-top:14px;">
        <a href="/admin/orders" style="text-decoration:none;">← Zamówienia</a>
    </p>
</main>
</body>
</html>
