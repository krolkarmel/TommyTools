<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>Admin - Produkty</title>
</head>
<body style="font-family:system-ui; margin:0; color:#111; background:#fafafa;">

<div th:replace="~{fragments/navbar :: nav}"></div>

<main style="max-width:980px; margin:22px auto; padding:0 16px;">
    <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
        <h1 style="margin:10px 0;">Panel admina: Produkty</h1>

        <a href="/admin/products/new"
           style="text-decoration:none; padding:10px 12px; border-radius:12px; border:1px solid #ddd; background:#fff;">
            + Dodaj produkt
        </a>
    </div>

    <div th:if="${msg != null}"
         style="margin:12px 0; padding:12px; border:1px solid #d9f0d9; background:#f3fff3; border-radius:12px;"
         th:text="${msg}">
        OK
    </div>

    <div th:if="${products == null || #lists.isEmpty(products)}"
         style="padding:18px; border:1px solid #e5e5e5; border-radius:16px; background:#fff;">
        Brak produktów.
    </div>

    <div th:if="${products != null && !#lists.isEmpty(products)}"
         style="margin-top:12px; background:#fff; border:1px solid #e5e5e5; border-radius:16px; overflow:hidden;">

        <div style="display:grid; grid-template-columns: 90px 1fr 140px 220px; padding:12px; font-weight:700; border-bottom:1px solid #eee;">
            <div>Foto</div>
            <div>Nazwa</div>
            <div>Cena</div>
            <div>Akcje</div>
        </div>

        <div th:each="p : ${products}"
             style="display:grid; grid-template-columns: 90px 1fr 140px 220px; padding:12px; align-items:center; border-bottom:1px solid #f0f0f0; gap:10px;">

            <div style="width:72px; height:54px; border:1px solid #eee; border-radius:10px; overflow:hidden; background:#f6f6f6; display:flex; align-items:center; justify-content:center;">
                <img th:if="${p.imageUrl != null && !#strings.isEmpty(p.imageUrl)}"
                     th:src="@{${p.imageUrl}}"
                     th:alt="${p.name}"
                     style="max-width:100%; max-height:100%; object-fit:contain;"/>
                <span th:if="${p.imageUrl == null || #strings.isEmpty(p.imageUrl)}" style="color:#999; font-size:12px;">
                    brak
                </span>
            </div>

            <div>
                <div style="font-weight:700;" th:text="${p.name}">Nazwa</div>
                <div style="color:#666; font-size:12px;">ID: <span th:text="${p.id}">1</span></div>
            </div>

            <div style="font-weight:800;" th:text="${p.price} + ' zł'">0 zł</div>

            <div style="display:flex; gap:8px; align-items:center;">
                <a th:href="@{'/admin/products/' + ${p.id} + '/edit'}"
                   style="text-decoration:none; padding:8px 10px; border-radius:10px; border:1px solid #ddd; background:#fff;">
                    Edytuj
                </a>

                <form th:action="@{'/admin/products/' + ${p.id} + '/delete'}" method="post" style="margin:0;">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <button type="submit"
                            onclick="return confirm('Usunąć produkt?')"
                            style="padding:8px 10px; border-radius:10px; border:1px solid #f1c0c0; background:#fff; cursor:pointer;">
                        Usuń
                    </button>
                </form>
            </div>
        </div>
    </div>

    <p style="margin-top:16px; color:#666;">
        Podgląd sklepu: <a href="/products">/products</a>
    </p>
</main>

</body>
</html>
