<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>Koszyk</title>
</head>
<body style="font-family:system-ui; margin:0; color:#111; background:#fafafa;">

<div th:replace="~{fragments/navbar :: nav}"></div>

<main style="max-width:980px; margin:22px auto; padding:0 16px;">
    <h1 style="margin:10px 0 18px;">Koszyk</h1>

    <div th:if="${cart == null || cart.lines == null || #lists.isEmpty(cart.lines)}"
         style="padding:18px; border:1px solid #e5e5e5; border-radius:16px; background:#fff;">
        Koszyk jest pusty. <a th:href="@{/products}">Wróć do produktów</a>
    </div>

    <div th:if="${cart != null && cart.lines != null && !#lists.isEmpty(cart.lines)}"
         style="display:flex; flex-direction:column; gap:12px;">

        <div th:each="line : ${cart.lines}"
             style="background:#fff; border:1px solid #e5e5e5; border-radius:16px; padding:14px; display:flex; justify-content:space-between; gap:10px; align-items:center;">

            <div>
                <div style="font-weight:700;" th:text="${line.product.name}">Nazwa</div>
                <div style="color:#666; font-size:14px;">
                    Ilość: <b th:text="${line.quantity}">1</b>
                </div>
            </div>

            <div style="display:flex; gap:12px; align-items:center;">
                <div style="font-weight:800;" th:text="${line.lineTotal} + ' zł'">0 zł</div>

                <form th:action="@{/cart/remove}" method="post" style="margin:0;">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <input type="hidden" name="id" th:value="${line.product.id}"/>
                    <button type="submit"
                            style="padding:10px 12px; border-radius:12px; border:1px solid #ddd; background:#fff; cursor:pointer;">
                        Usuń
                    </button>
                </form>
            </div>
        </div>

        <div style="margin-top:6px; padding:14px; border:1px solid #e5e5e5; border-radius:16px; background:#fff; display:flex; justify-content:space-between; align-items:center;">
            <div style="color:#666;">
                Razem sztuk: <b th:text="${cart.totalItems}">0</b>
            </div>
            <div style="font-weight:900; font-size:18px;">
                Suma: <span th:text="${cart.totalPrice} + ' zł'">0 zł</span>
            </div>
        </div>

    </div>
</main>

</body>
</html>
